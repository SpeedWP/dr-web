var AdsController={debug:!1,placements:[],zoneVisibilityMediaQueries:{},registerPlacements:function(t){this.placements=t},AdGroup:function(t,e){this.name=t,this.primaryZones=[],this.mixinZones=[],this.primaryAds=[],this.mixinAds=[],this.emptyAds=[],this.mixinFactor=2,this.combinedAds=[],this.adscontroller=e,this.addPrimary=function(t,e){for(var i=0;e>i;i++)this.primaryZones.push({name:"group-"+this.name+"-"+(this.primaryZones.length+1),id:t})},this.addMixin=function(t,e){for(var i=0;e>i;i++)this.mixinZones.push({name:"group-"+this.name+"-mixin-"+(this.mixinZones.length+1),id:t})},this.getName=function(){return this.name},this.getAllZones=function(){return this.primaryZones.concat(this.mixinZones)},this.postLoad=function(){e.log("AdGroup "+this.getName()+": postLoad. "+this.primaryZones.length+" primary zones. "+this.mixinZones.length+" mixins.");for(var i=0;i<this.primaryZones.length;i++)"undefined"==typeof OA_output[this.primaryZones[i].name]||e.isEmptyAd(OA_output[this.primaryZones[i].name])?"undefined"!=typeof OA_output[this.primaryZones[i].name]&&this.emptyAds.push({name:this.primaryZones[i].name,content:OA_output[this.primaryZones[i].name],factor:1}):this.primaryAds.push({name:this.primaryZones[i].name,content:OA_output[this.primaryZones[i].name],factor:1});for(var i=0;i<this.mixinZones.length;i++)e.log("AdGroup "+t+": Checking mixin "+i+": "+this.mixinZones[i].name),"undefined"==typeof OA_output[this.mixinZones[i].name]||e.isEmptyAd(OA_output[this.mixinZones[i].name])||this.mixinAds.push({name:this.mixinZones[i].name,content:OA_output[this.mixinZones[i].name],factor:this.mixinFactor});for(;this.primaryAds.length+this.mixinAds.length*this.mixinFactor>this.primaryZones.length;)this.primaryAds.pop();this.adscontroller.shuffle_array(this.primaryAds),this.adscontroller.shuffle_array(this.mixinAds);for(var i=0;i<this.primaryAds.length;i++)this.combinedAds.push(this.primaryAds[i]);for(var i=0;i<this.mixinAds.length;i++){for(var s=Math.floor(Math.random()*(this.combinedAds.length/this.mixinFactor+1)),n=0,o=0;n<s*this.mixinFactor&&o<this.combinedAds.length;)n+=this.combinedAds[o].factor,o++;this.combinedAds.splice(o,0,this.mixinAds[i])}e.log("AdGroup "+t+": Appending up to "+this.emptyAds.length+" empty ads."),e.log("AdGroup "+t+": Primary length: "+this.primaryZones.length),e.log("AdGroup "+t+": Prepared ads: "+this.combinedAds.length),e.log("AdGroup "+t+": Mixed in ads: "+this.mixinAds.length);var r=this.primaryZones.length-this.combinedAds.length-this.mixinAds.length;e.log("AdGroup "+t+": => # of empty ads to append: "+r);for(var i=0;r>i;i++)e.log("AdGroup "+t+": "+i+". Appending one empty ad"),this.emptyAds.length>0?this.combinedAds.push(this.emptyAds.shift()):e.log("AdGroup "+t+": ... no empty ad available")},this.shift=function(){return this.combinedAds.shift()}},_newAdGroups:[],getAdGroup:function(t){for(var e=0;e<this._newAdGroups.length;e++)if(this._newAdGroups[e].getName()==t)return this._newAdGroups[e];var i=new this.AdGroup(t,this);return this._newAdGroups.push(i),i},init:function(){"#debug"==window.location.hash&&(this.debug=!0),this.debug&&(this.documentWrite=document.write,document.write=function(t){console.log("document.write: ",t),AdsController.documentWrite.call(document,t)}),OA_zones={},this.readPlacements();for(var t=[],e=0;e<this.placements.length;e++)if(this.log("Setting up placement "+this.placements[e].name),"undefined"!=typeof this.placements[e].newGroup&&this.placements[e].newGroup);else if("undefined"!=typeof this.placements[e].list&&this.placements[e].list&&this.placements[e].list>0){var i=this.placements[e].group;this.log("Placement belongs to group "+i),"undefined"==typeof t[i]&&(t[i]=0);for(var s=1;s<=this.placements[e].list;s++){t[i]++;var n=i+"-"+t[i];OA_zones[n]=this.placements[e].zone,"undefined"!=typeof this.placements[e].visibility&&null!==this.placements[e].visibility&&(this.zoneVisibilityMediaQueries[n]=this.placements[e].visibility)}if(this.log("Prepared placements for group "+i),"undefined"!=typeof this.placements[e].mixin&&this.placements[e].mixin){var o="mixin-"+this.placements[e].mixin;"undefined"==typeof t[o]&&(t[o]=0);for(var s=1;s<=this.placements[e].mixinList;s++){t[o]++;var n=o+"-"+t[o];OA_zones[n]=this.placements[e].mixin,"undefined"!=typeof this.placements[e].visibility&&null!==this.placements[e].visibility&&(this.zoneVisibilityMediaQueries[n]=this.placements[e].visibility)}this.log("Prepared placements for mixin group "+o)}}else OA_zones[this.placements[e].name]=this.placements[e].zone,"undefined"!=typeof this.placements[e].visibility&&null!==this.placements[e].visibility&&(this.zoneVisibilityMediaQueries[this.placements[e].name]=this.placements[e].visibility);for(var e=0;e<this._newAdGroups.length;e++)for(var r=this._newAdGroups[e].getAllZones(),a=0;a<r.length;a++)OA_zones[r[a].name]=r[a].id},readPlacements:function(){var t=document.querySelectorAll("[data-ad-zone-id]");this.log("readPlacements: Found targets: ",t);for(var e=0;e<t.length;e++){var i=t[e].getAttribute("data-ad-zone-id"),s=t[e].getAttribute("data-ad-visibility"),n=t[e].getAttribute("data-ad-list"),o=t[e].getAttribute("data-ad-mixin-zone-id"),r=t[e].getAttribute("data-ad-mixin-list"),a=t[e].getAttribute("id"),d=t[e].getAttribute("data-ad-fetchonly");if(null!=i&&""!=i)if(null!=a&&""!=a){document.querySelectorAll('[id="'+a+'"]').length>1&&this.error("Error initializing placement "+a+": Duplicate id.");var h=t[e].getAttribute("data-ad-group");if(h){this.log("Loading group data: "+h);var l=this.getAdGroup(h);l.addPrimary(i,n),o?l.addMixin(o,r):this.log("Loading group data: "+h+" has no mixins."),this.log("Group "+l+" loaded."),this.placements.push({name:a,newGroup:h,list:n,visibility:s,fetchonly:d})}else this.placements.push({name:a,zone:i,list:n,visibility:s,group:"group"+i,mixin:o,mixinList:r,fetchonly:d})}else this.error("readPlacements, target "+e+": Missing target id:"+t[e].outerHTML);else this.error("readPlacements, target "+e+": Missing zone id:"+t[e].outerHTML)}},load:function(){if(this.init(),"undefined"==typeof OA_zones)throw"Ad zones not defined";var t="";for(var e in OA_zones)t+=escape(e+"="+OA_zones[e]+"|");if(t+="&amp;nz=1","undefined"==typeof i)var i="";var s="https:"==location.protocol?"https://auslieferung.commindo-media-ressourcen.de/www/delivery/spc.php":"http://auslieferung.commindo-media-ressourcen.de/www/delivery/spc.php",n=Math.floor(99999999*Math.random()),o="<script type='text/javascript' ";o+="src='"+s+"?zones="+t,o+="&amp;source="+escape(i)+"&amp;r="+n,o+="&amp;block=1&amp;blockcampaign=1&amp;withtext=1",o+=document.charset?"&amp;charset="+document.charset:document.characterSet?"&amp;charset="+document.characterSet:"",window.location&&(o+="&amp;loc="+escape(window.location)),document.referrer&&(o+="&amp;referer="+escape(document.referrer)),o+="'></script>",document.write(o)},_adGroups:[],prepareAdGroup:function(t){if("undefined"==typeof this._adGroups[t]){for(var e=[],i=1;90>i&&"undefined"!=typeof OA_output[t+"-"+i];i++)this.isEmptyAd(OA_output[t+"-"+i])||e.push(t+"-"+i);this.shuffle_array(e),this._adGroups[t]=e}},postLoad:function(){this.log("postLoad():"),this.log(OA_output);for(var t=0;t<this._newAdGroups.length;t++)this._newAdGroups[t].postLoad();document.write('<div id="bannersource">');for(var t=0;t<this.placements.length;t++)if("true"!==this.placements[t].fetchonly)if("undefined"!=typeof this.placements[t].newGroup)for(var e=this.getAdGroup(this.placements[t].newGroup),i=0;i<this.placements[t].list;){var s=e.shift();if(!s)break;i+=s.factor,this.showAd(s.name,this.placements[t].name,this.placements[t].visibility)}else if("undefined"!=typeof this.placements[t].list&&this.placements[t].list&&this.placements[t].list>0){var n=this.placements[t].group;if(this.log("Displaying ad group "+n),this.prepareAdGroup(n),"undefined"!=typeof this.placements[t].mixin&&this.placements[t].mixin){var o=2,r="mixin-"+this.placements[t].mixin;this.log("Mixing in: "+r),this.prepareAdGroup(r);var a=0;for(irl=0;irl<this.placements.length;irl++)this.placements[irl].group==n&&(a+=parseInt(this.placements[irl].list));for(var d=[],h=0;h<this._adGroups[r].length;h++){var l=null,p=1;do l=Math.floor(Math.random()*(this._adGroups[n].length/o+1)),p++;while(-1!=d.indexOf(l)&&30>p);d.push(l),this.log("Adding mixin on line "+l)}for(var u=[],m=0;this._adGroups[n].length>0;)this._adGroups[r].length>0&&-1!==d.indexOf(m/o)?(u.push(this._adGroups[r].pop()),m+=o):(u.push(this._adGroups[n].pop()),m++);for(;this._adGroups[r].length>0;)u.push(this._adGroups[r].pop());this._adGroups[n]=u}for(var c=1;c<=this.placements[t].list&&this._adGroups[this.placements[t].group].length>0;c++)this.showAd(this._adGroups[this.placements[t].group].shift(),this.placements[t].name);this.log("... placement complete.")}else this.showAd(this.placements[t].name,this.placements[t].name);else this.log("Placement "+this.placements[t].name+" is set to fetch-only, not rendering.");document.write("</div>")},postPostLoad:function(){this.processMoveAdQueue()},shuffle_array:function(t){var e=t.length;if(0==e)return!1;for(;--e;){var i=Math.floor(Math.random()*(e+1)),s=t[e],n=t[i];t[e]=n,t[i]=s}},shuffleAds:function(t,e){var i=[],s=[];if("undefined"!=typeof OA_output){for(var n=1;e>=n;n++)void 0===OA_output[t+n]||this.isEmptyAd(OA_output[t+n])||(i.push(OA_output[t+n]),s.push(n));this.shuffle_array(i);for(var o=0,n=1;e>=n;n++)-1!=s.indexOf(n)&&void 0!==i[o]?(OA_output[t+n]=i[o],o++):OA_output[t+n]=""}},showAd:function(t,e,i){if(2!=arguments.length&&3!=arguments.length)throw"showAd(): Unexpected number of arguments. Expected 2 or 3.";if(this.trigger("before-showad",t,e),target=document.getElementById(e),!target)return void this.log("showAd("+t+"): Target ("+e+") not available, not displaying.");if(this.testZoneVisibility(t,i),"string"!=typeof OA_output[t]||""===OA_output[t])return void this.log("showAd("+t+"): No ad available.");this.log("showAd("+t+"): Outputting ad.");var s="source-"+e+"-"+t,n='<div id="'+s+'" class="ad-'+t;this.isEmptyAd(OA_output[t])&&(this.log("showAd("+t+"): Ad is empty."),n+=" ad-is-empty"),n+='">'+OA_output[t]+"</div>",document.write(n),this.moveAd(s,e)},showAdGroup:function(t,e,i){for(var s=this.getAdGroup(t),n=0;i>n;){var o=s.shift();if(!o)break;n+=o.factor,this.showAd(o.name,e)}},moveAdQueue:[],moveAd:function(t,e){this.log('moveAd("'+t+'", "'+e+'")');var i=document.getElementById(e),s=document.getElementById(t);i&&s?i.appendChild(s):(this.log("item or target not found. Will not move, but adding to queue"),this.log(i),this.log(s),this.moveAdQueue.push({source:t,target:e}))},processMoveAdQueue:function(){this.log("Processing moveAdQueue...");var t=this.moveAdQueue.slice();this.moveAdQueue=[];for(var e=0;e<t.length;e++)this.moveAd(t[e].source,t[e].target)},OA_show:function(t){AdsController.showAd(t)},testZoneVisibility:function(t,e){var i=null;if("undefined"!=typeof e?i=e:"undefined"!=typeof this.zoneVisibilityMediaQueries[t]&&(i=this.zoneVisibilityMediaQueries[t]),i){this.log("Testing visibility for "+t);var s=!0;window.matchMedia?window.matchMedia(i).matches||(s=!1):this.log("Aborting test. No matchMedia."),s||(this.log(t+" not visible. Disabling. Failed media query: "+i),OA_output[t]="")}else this.log("No visibility media query defined for "+t)},OA_beacons:{},extract_beacon:function(t){var e=/\<div id\=\'beacon_[a-z0-9]+\'.*?\<\/div\>\s*/;void 0!=OA_output[t]&&(this.OA_beacons[t]=OA_output[t].match(e),OA_output[t]=OA_output[t].replace(e,""))},log:function(t){this.debug&&console.log(t)},error:function(t){console.error&&console.error(t)},disableZone:function(t){return"undefined"==typeof OA_output?void this.log("disableZone("+t+"): OA_output not defined"):"undefined"==typeof OA_output[t]?void this.log("disableZone("+t+"): id not found"):(this.log("disableZone("+t+"): Removing ad. Content: "+OA_output[t]),delete OA_output[t],"undefined"==typeof OA_zones?void this.log("disableZone("+t+"): OA_zones not defined"):"undefined"==typeof OA_zones[t]?void this.log("disableZone("+t+"): id not found in zones"):(this.log("disableZone("+t+"): Disabling zone."),void delete OA_zones[t]))},isEmptyAd:function(t){return null===t?!0:""===t?!0:t.match(/^\s*<div id='beacon_[^>]*><img [^>]*><\/div>\s*$/)?!0:!1},_callbacks:[],on:function(t,e){"undefined"==typeof this._callbacks[t]&&(this._callbacks[t]=[]),this._callbacks[t].push(e)},trigger:function(){var t=arguments[0];if("undefined"!=typeof this._callbacks[t])for(var e=0;e<this._callbacks[t].length;e++)this._callbacks[t][e].apply(this,Array.prototype.slice.call(arguments,1))}};Array.prototype.indexOf||(Array.prototype.indexOf=function(t){var e=this.length>>>0,i=Number(arguments[1])||0;for(i=0>i?Math.ceil(i):Math.floor(i),0>i&&(i+=e);e>i;i++)if(i in this&&this[i]===t)return i;return-1});
if(typeof org=="undefined"){var org={}}if(typeof org.openx=="undefined"){org.openx={}}if(typeof org.openx.util=="undefined"){org.openx.util={}}if(typeof org.openx.SWFObjectUtil=="undefined"){org.openx.SWFObjectUtil={}}org.openx.SWFObject=function(f,d,m,g,j,l,n,i,a,e){if(!document.getElementById){return}this.DETECT_KEY=e?e:"detectflash";this.skipDetect=org.openx.util.getRequestParameter(this.DETECT_KEY);this.params=new Object();this.variables=new Object();this.attributes=new Array();if(f){this.setAttribute("swf",f)}if(d){this.setAttribute("id",d)}if(m){this.setAttribute("width",m)}if(g){this.setAttribute("height",g)}if(j){this.setAttribute("version",new org.openx.PlayerVersion(j.toString().split(".")))}this.installedVer=org.openx.SWFObjectUtil.getPlayerVersion();if(!window.opera&&document.all&&this.installedVer.major>7){org.openx.SWFObject.doPrepUnload=true}if(l){this.addParam("bgcolor",l)}var b=n?n:"high";this.addParam("quality",b);var k=(i)?i:window.location;this.setAttribute("xiRedirectUrl",k);this.setAttribute("redirectUrl","");if(a){this.setAttribute("redirectUrl",a)}};org.openx.SWFObject.prototype={setAttribute:function(a,b){this.attributes[a]=b},getAttribute:function(a){return this.attributes[a]},addParam:function(a,b){this.params[a]=b},getParams:function(){return this.params},addVariable:function(a,b){this.variables[a]=b},getVariable:function(a){return this.variables[a]},getVariables:function(){return this.variables},getVariablePairs:function(){var a=new Array();var b;var c=this.getVariables();for(b in c){a[a.length]=b+"="+c[b]}return a},getSWFHTML:function(){var d="";if(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length){d='<embed type="application/x-shockwave-flash" src="'+this.getAttribute("swf")+'" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'" style="'+this.getAttribute("style")+'"';d+=' id="'+this.getAttribute("id")+'" name="'+this.getAttribute("id")+'" ';var c=this.getParams();for(var a in c){d+=[a]+'="'+c[a]+'" '}var b=this.getVariablePairs().join("&");if(b.length>0){d+='flashvars="'+b+'"'}d+="/>"}else{d='<object id="'+this.getAttribute("id")+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'" style="'+this.getAttribute("style")+'">';d+='<param name="movie" value="'+this.getAttribute("swf")+'" />';var c=this.getParams();for(var a in c){d+='<param name="'+a+'" value="'+c[a]+'" />'}var b=this.getVariablePairs().join("&");if(b.length>0){d+='<param name="flashvars" value="'+b+'" />'}d+="</object>"}return d},write:function(a,b,d){if(this.skipDetect||this.installedVer.versionIsValid(this.getAttribute("version"))){var c=(typeof a=="string")?document.getElementById(a):a;c.innerHTML=this.getSWFHTML();this.logImpression(c,b);return true}else{if(this.getAttribute("redirectUrl")!=""){document.location.replace(this.getAttribute("redirectUrl"))}}this.logImpression(c,d);return false},logImpression:function(c,a){if(a){var b=document.createElement("IMG");b.style.position="absolute";b.style.width=0;b.src=a;c.appendChild(b)}}};org.openx.SWFObjectUtil.getPlayerVersion=function(){var c=new org.openx.PlayerVersion([0,0,0]);if(navigator.plugins&&navigator.mimeTypes.length){var a=navigator.plugins["Shockwave Flash"];if(a&&a.description){c=new org.openx.PlayerVersion(a.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split("."))}}else{if(navigator.userAgent&&navigator.userAgent.indexOf("Windows CE")>=0){var d=1;var b=3;while(d){try{b++;d=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+b);c=new org.openx.PlayerVersion([b,0,0])}catch(f){d=null}}}else{try{var d=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7")}catch(f){try{var d=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");c=new org.openx.PlayerVersion([6,0,21]);d.AllowScriptAccess="always"}catch(f){if(c.major==6){return c}}try{d=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(f){}}if(d!=null){c=new org.openx.PlayerVersion(d.GetVariable("$version").split(" ")[1].split(","))}}}return c};org.openx.PlayerVersion=function(a){this.major=a[0]!=null?parseInt(a[0]):0;this.minor=a[1]!=null?parseInt(a[1]):0;this.rev=a[2]!=null?parseInt(a[2]):0};org.openx.PlayerVersion.prototype.versionIsValid=function(a){if(this.major<a.major){return false}if(this.major>a.major){return true}if(this.minor<a.minor){return false}if(this.minor>a.minor){return true}if(this.rev<a.rev){return false}return true};org.openx.util={getRequestParameter:function(d){var c=document.location.search||document.location.hash;if(d==null){return c}if(c){var b=c.substring(1).split("&");for(var a=0;a<b.length;a++){if(b[a].substring(0,b[a].indexOf("="))==d){return b[a].substring((b[a].indexOf("=")+1))}}}return""}};org.openx.SWFObjectUtil.cleanupSWFs=function(){var c=document.getElementsByTagName("OBJECT");for(var b=c.length-1;b>=0;b--){c[b].style.display="none";for(var a in c[b]){if(typeof c[b][a]=="function"){c[b][a]=function(){}}}}};if(org.openx.SWFObject.doPrepUnload){if(!org.openx.unloadSet){org.openx.SWFObjectUtil.prepUnload=function(){__flash_unloadHandler=function(){};__flash_savedUnloadHandler=function(){};window.attachEvent("onunload",org.openx.SWFObjectUtil.cleanupSWFs)};window.attachEvent("onbeforeunload",org.openx.SWFObjectUtil.prepUnload);org.openx.unloadSet=true}}if(!document.getElementById&&document.all){document.getElementById=function(a){return document.all[a]}}var getQueryParamValue=org.openx.util.getRequestParameter;var FlashObject=org.openx.SWFObject;var SWFObject=org.openx.SWFObject;document.mmm_fo=1;
